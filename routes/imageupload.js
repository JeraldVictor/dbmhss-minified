let express=require("express"),fs=require("fs"),router=express.Router();const multer=require("multer"),storage=multer.diskStorage({filename:function(e,o,a){console.log(o),global.fn=o.originalname,console.log(global.fn),a(null,global.fn)},destination:function(e,o,a){a(null,"./public/uploads")}}),upload=multer({storage:storage});router.get("/:name/:add",function(e,o){let a=e.params.add,l=e.params.name.toUpperCase();console.log(a+"\t"+l);let t={name:l,add_no:a};o.render("pic-upload",{title:"Image Upload",list:t})}),router.post("/:sname/:add_no",upload.single("profileImage"),function(e,o){let a=e.params.add_no,l=e.params.sname;console.log(l+"\t"+a);let t="./public/uploads/"+fn,n="./public/uploads/"+l+"-"+a+".jpg",r={name:l,add_no:a,msg:"Image Uploaded"};console.log(n),console.log(t),fs.renameSync(t,n),o.render("pic-upload",{title:"Image Upload",list:r})}),router.get("/teacher/:tname/:tid",function(e,o){tid=e.params.tid,tname=e.params.tname,console.log(tid+"\t"+tname);let a={tname:tname,tid:tid};o.render("pic-upload-teacher",{title:"Image Upload",list:a})}),router.post("/teacher/:tname/:tid",upload.single("profileImage"),function(e,o){let a=e.params.tid,l=e.params.tname;console.log(l+"\t"+a);let t="./public/uploads/"+global.fn,n="./public/uploads/"+l+"-"+a+".jpg",r={tname:l,tid:a,msg:"Image Uploaded"};console.log(n),console.log(t),fs.renameSync(t,n),o.render("pic-upload-teacher",{title:"Image Upload",list:r})}),module.exports=router;
